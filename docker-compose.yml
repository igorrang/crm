
services:
 # phpmyadmin:
  #  depends_on:
   #   - db
    #image: phpmyadmin/phpmyadmin
    #ports:
    #  - "8080:80"
   # environment:
    #  PMA_HOST: db

  db:
    container_name: mycontainername
    image: mysql/mysql-server:8.0.23
    volumes:
       - /users/igorrangelkonvictus/dumps:/var/lib/mysql
    environment:
      MYSQL_DATABASE: botecobrasil
      MYSQL_USER: root
      MYSQL_ROOT_PASSWORD: 12345
    build: 
      context: ./banco
      
    ports:
      - "3306:3306"  # Porta onde o banco de dados rodará
    networks:
      - app-network
  frontend:
    image: frontendcrm 
    #platform: linux/amd64
    build: 
      context: ./frontend
    # Exemplo com Node.js, pode mudar conforme seu projeto
    container_name: frontend
    working_dir: /app
    command: pm2-runtime npm --name "next-app" -- start
       # Atualize o caminho do .env
    ports:
      - "3000:3000"  # Porta onde o frontend rodará
     # O comando para rodar o frontend
    depends_on:
      - backend
    networks:
      - app-network

  backend:
    image: backendcrm
   # platform: linux/amd64
    build: 
      context: ./backend
     # Pode mudar conforme a sua stack
    container_name: backend
    working_dir: /src
    volumes:
      - ./backend:/src/server.js
    ports:
      - "5050:5050"  # Porta onde o backend rodará
    command: pm2-runtime start server.js  # O comando para rodar o backend
    depends_on:
      - db
    networks:
      - app-network
    environment:
      #- DB_HOST=92.112.179.19 # Nome do serviço do banco de dados no Compose
      #- DB_PORT=3306
      #- DB_USER=konv_root  # Exemplo com PostgreSQL, ajustar conforme o banco de dados usado
      #- DB_PASSWORD=12345
      #- DB_NAME=konv_botecobrasil
    
      
 
       - NODE_ENV=production
       - PORT=5050
       - BASE_URL:"http://localhost"
      
 

networks:
  app-network:
    driver: bridge